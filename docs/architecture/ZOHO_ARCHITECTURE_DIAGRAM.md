# Zoho Integration Visual Architecture

## System Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ZOHO INVENTORY INTEGRATION                      â”‚
â”‚                              (Complete System)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. USER INTERFACE                                                        â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  DJANGO ADMIN (Jazzmin)                                        â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚  Top Menu:                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚    â”‚
â”‚  â”‚  â”‚ Home â”‚ â”‚ User â”‚ â”‚ ğŸ”„ Sync Zoho â”‚ â—„â”€â”€â”€â”€ NEW BUTTON         â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚  Sidebar:                                                       â”‚    â”‚
â”‚  â”‚  ğŸ“ Integrations (NEW)                                         â”‚    â”‚
â”‚  â”‚     â””â”€ ğŸ”‘ Zoho Credentials â—„â”€â”€â”€â”€ SINGLETON CONFIG            â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚  ğŸ“ Products and Services                                      â”‚    â”‚
â”‚  â”‚     â””â”€ ğŸ“¦ Products                                            â”‚    â”‚
â”‚  â”‚         â””â”€ Action: "Sync selected items" â—„â”€â”€â”€â”€ NEW ACTION    â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ User clicks "Sync Zoho"
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. WEB LAYER                                                             â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                          â”‚
â”‚  URL: /crm-api/products/admin/sync-zoho/                      â”‚
â”‚       â”‚                                                                  â”‚
â”‚       â–¼                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚  trigger_sync_view(request)                    â”‚                    â”‚
â”‚  â”‚  â””â”€ @staff_member_required decorator           â”‚                    â”‚
â”‚  â”‚  â””â”€ Security check passed âœ“                    â”‚                    â”‚
â”‚  â”‚  â””â”€ Trigger async task                         â”‚                    â”‚
â”‚  â”‚  â””â”€ Return: "Task initiated: task_id_12345"    â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚       â”‚                                                                  â”‚
â”‚       â”‚ Creates Celery task                                            â”‚
â”‚       â–¼                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. TASK QUEUE (Celery + Redis)                                          â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  REDIS QUEUE                                                 â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚       â”‚
â”‚  â”‚  â”‚ Task: task_sync_zoho_products                        â”‚   â”‚       â”‚
â”‚  â”‚  â”‚ ID: task_id_12345                                    â”‚   â”‚       â”‚
â”‚  â”‚  â”‚ Status: PENDING â†’ STARTED â†’ SUCCESS/FAILURE          â”‚   â”‚       â”‚
â”‚  â”‚  â”‚ Retries: 3 attempts, 60s delay                       â”‚   â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                    â”‚                                    â”‚
â”‚                                    â”‚ Celery worker picks up task        â”‚
â”‚                                    â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  CELERY WORKER                                              â”‚       â”‚
â”‚  â”‚  task_sync_zoho_products.delay()                           â”‚       â”‚
â”‚  â”‚  â””â”€ Executes in background                                  â”‚       â”‚
â”‚  â”‚  â””â”€ Non-blocking (UI stays responsive)                      â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. BUSINESS LOGIC LAYER                                                  â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  sync_zoho_products_to_db()                                 â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚       â”‚
â”‚  â”‚  â”‚ Step 1: Initialize ZohoClient                      â”‚    â”‚       â”‚
â”‚  â”‚  â”‚   â””â”€ Get credentials from DB (singleton)           â”‚    â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚       â”‚
â”‚  â”‚  â”‚ Step 2: Validate & Refresh Token                   â”‚    â”‚       â”‚
â”‚  â”‚  â”‚   â””â”€ Check is_expired()                            â”‚    â”‚       â”‚
â”‚  â”‚  â”‚   â””â”€ Auto-refresh if needed                        â”‚    â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚       â”‚
â”‚  â”‚  â”‚ Step 3: Fetch Products from Zoho                   â”‚    â”‚       â”‚
â”‚  â”‚  â”‚   â””â”€ fetch_all_products()                          â”‚    â”‚       â”‚
â”‚  â”‚  â”‚   â””â”€ Handles pagination automatically              â”‚    â”‚       â”‚
â”‚  â”‚  â”‚   â””â”€ 200 items per API call                        â”‚    â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚       â”‚
â”‚  â”‚  â”‚ Step 4: Process Each Item                          â”‚    â”‚       â”‚
â”‚  â”‚  â”‚   â””â”€ Map Zoho fields â†’ Product fields              â”‚    â”‚       â”‚
â”‚  â”‚  â”‚   â””â”€ Product.objects.update_or_create()            â”‚    â”‚       â”‚
â”‚  â”‚  â”‚   â””â”€ By zoho_item_id (unique identifier)           â”‚    â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚       â”‚
â”‚  â”‚  â”‚ Step 5: Error Handling                             â”‚    â”‚       â”‚
â”‚  â”‚  â”‚   â””â”€ Individual failures logged                    â”‚    â”‚       â”‚
â”‚  â”‚  â”‚   â””â”€ Continue with remaining items                 â”‚    â”‚       â”‚
â”‚  â”‚  â”‚   â””â”€ Return statistics                             â”‚    â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚       â”‚
â”‚  â”‚                                                             â”‚       â”‚
â”‚  â”‚  Returns: {                                                 â”‚       â”‚
â”‚  â”‚    total: 150,                                              â”‚       â”‚
â”‚  â”‚    created: 100,                                            â”‚       â”‚
â”‚  â”‚    updated: 50,                                             â”‚       â”‚
â”‚  â”‚    failed: 0,                                               â”‚       â”‚
â”‚  â”‚    errors: []                                               â”‚       â”‚
â”‚  â”‚  }                                                          â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                              â”‚
                     â”‚                              â”‚
                     â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. EXTERNAL API             â”‚   â”‚ 6. DATABASE                          â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                              â”‚   â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ZOHO INVENTORY API     â”‚ â”‚   â”‚  â”‚ PostgreSQL / SQLite             â”‚ â”‚
â”‚  â”‚                        â”‚ â”‚   â”‚  â”‚                                 â”‚ â”‚
â”‚  â”‚ GET /api/v1/items      â”‚â—„â”¼â”€â”€â”€â”¼â”€â”€â”‚ ZohoCredential (1 row)         â”‚ â”‚
â”‚  â”‚ ?organization_id=...   â”‚ â”‚   â”‚  â”‚  â”œâ”€ client_id                  â”‚ â”‚
â”‚  â”‚ ?page=1&per_page=200   â”‚ â”‚   â”‚  â”‚  â”œâ”€ client_secret              â”‚ â”‚
â”‚  â”‚                        â”‚ â”‚   â”‚  â”‚  â”œâ”€ access_token â—„â”€â”€â”          â”‚ â”‚
â”‚  â”‚ Response:              â”‚ â”‚   â”‚  â”‚  â”œâ”€ refresh_token    â”‚ Auto-   â”‚ â”‚
â”‚  â”‚ {                      â”‚ â”‚   â”‚  â”‚  â”œâ”€ expires_in       â”‚ refresh â”‚ â”‚
â”‚  â”‚   code: 0,             â”‚ â”‚   â”‚  â”‚  â””â”€ organization_id  â”‚         â”‚ â”‚
â”‚  â”‚   items: [...],        â”‚ â”‚   â”‚  â”‚                      â”‚         â”‚ â”‚
â”‚  â”‚   page_context: {...}  â”‚â”€â”¼â”€â”€â”€â”¼â”€â”€â”‚ Product (N rows)    â”‚         â”‚ â”‚
â”‚  â”‚ }                      â”‚ â”‚   â”‚  â”‚  â”œâ”€ id               â”‚         â”‚ â”‚
â”‚  â”‚                        â”‚ â”‚   â”‚  â”‚  â”œâ”€ name             â”‚         â”‚ â”‚
â”‚  â”‚ Headers:               â”‚ â”‚   â”‚  â”‚  â”œâ”€ sku              â”‚         â”‚ â”‚
â”‚  â”‚ Authorization:         â”‚ â”‚   â”‚  â”‚  â”œâ”€ price            â”‚         â”‚ â”‚
â”‚  â”‚  Zoho-oauthtoken XXX   â”‚ â”‚   â”‚  â”‚  â”œâ”€ stock_quantity   â”‚         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚  â”‚  â””â”€ zoho_item_id â—„â”€â”€NEW        â”‚ â”‚
â”‚                              â”‚   â”‚  â”‚                                 â”‚ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚ ZOHO OAUTH TOKEN API   â”‚ â”‚   â”‚                                      â”‚
â”‚  â”‚                        â”‚ â”‚   â”‚  Operation: update_or_create()       â”‚
â”‚  â”‚ POST /oauth/v2/token   â”‚â—„â”¼â”€â”€â”€â”¼â”€â”€  â””â”€ by zoho_item_id (unique)     â”‚ â”‚
â”‚  â”‚ ?grant_type=refresh... â”‚ â”‚   â”‚     â””â”€ Idempotent (safe to re-run) â”‚ â”‚
â”‚  â”‚                        â”‚ â”‚   â”‚                                      â”‚
â”‚  â”‚ Response:              â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”‚ {                      â”‚ â”‚
â”‚  â”‚   access_token: "...", â”‚â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Updates credential
â”‚  â”‚   expires_in: 3600     â”‚ â”‚
â”‚  â”‚ }                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. LOGGING & MONITORING                                                  â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ logs/django.log         â”‚    â”‚ logs/celery.log          â”‚          â”‚
â”‚  â”‚                         â”‚    â”‚                          â”‚          â”‚
â”‚  â”‚ INFO: Starting sync...  â”‚    â”‚ INFO: Task started       â”‚          â”‚
â”‚  â”‚ INFO: Fetched 150 items â”‚    â”‚ INFO: Task success       â”‚          â”‚
â”‚  â”‚ INFO: Created 100       â”‚    â”‚ Task ID: task_id_12345   â”‚          â”‚
â”‚  â”‚ INFO: Updated 50        â”‚    â”‚ Duration: 45s            â”‚          â”‚
â”‚  â”‚ INFO: Sync complete     â”‚    â”‚ Result: {...}            â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Details

### Token Management
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OAuth Token Lifecycle                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Initial Setup (Manual):                                        â”‚
â”‚  1. Get authorization code from Zoho                            â”‚
â”‚  2. Exchange for access_token + refresh_token                   â”‚
â”‚  3. Store in ZohoCredential (singleton)                        â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Every API Call:                                          â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  get_valid_token()                                       â”‚ â”‚
â”‚  â”‚    â”‚                                                     â”‚ â”‚
â”‚  â”‚    â”œâ”€â”€â–º Check: is_expired()?                            â”‚ â”‚
â”‚  â”‚    â”‚       â”‚                                             â”‚ â”‚
â”‚  â”‚    â”‚       â”œâ”€â–º NO  â†’ Return existing access_token       â”‚ â”‚
â”‚  â”‚    â”‚       â”‚                                             â”‚ â”‚
â”‚  â”‚    â”‚       â””â”€â–º YES â†’ _refresh_token()                   â”‚ â”‚
â”‚  â”‚    â”‚                   â”‚                                 â”‚ â”‚
â”‚  â”‚    â”‚                   â”œâ”€â–º POST to Zoho OAuth API       â”‚ â”‚
â”‚  â”‚    â”‚                   â”œâ”€â–º Get new access_token         â”‚ â”‚
â”‚  â”‚    â”‚                   â”œâ”€â–º Calculate new expires_in     â”‚ â”‚
â”‚  â”‚    â”‚                   â”œâ”€â–º Save to database             â”‚ â”‚
â”‚  â”‚    â”‚                   â””â”€â–º Return new access_token      â”‚ â”‚
â”‚  â”‚    â”‚                                                     â”‚ â”‚
â”‚  â”‚    â””â”€â”€â–º Use token in API call                           â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  Buffer: 5 minutes before actual expiration                    â”‚
â”‚  â””â”€â–º Prevents race conditions                                  â”‚
â”‚  â””â”€â–º Ensures token always valid                                â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Sync Process
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Product Synchronization Flow                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  For Each Zoho Item:                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  1. Extract Data:                                        â”‚ â”‚
â”‚  â”‚     zoho_item = {                                        â”‚ â”‚
â”‚  â”‚       'item_id': '123',                                  â”‚ â”‚
â”‚  â”‚       'name': 'Widget',                                  â”‚ â”‚
â”‚  â”‚       'sku': 'WDG-001',                                  â”‚ â”‚
â”‚  â”‚       'rate': 99.99,                                     â”‚ â”‚
â”‚  â”‚       'stock_on_hand': 10,                               â”‚ â”‚
â”‚  â”‚       'status': 'active'                                 â”‚ â”‚
â”‚  â”‚     }                                                    â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  2. Validate:                                            â”‚ â”‚
â”‚  â”‚     if not item_id:                                      â”‚ â”‚
â”‚  â”‚       log_error()                                        â”‚ â”‚
â”‚  â”‚       stats['failed'] += 1                               â”‚ â”‚
â”‚  â”‚       continue  # Skip this item                         â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  3. Map Fields:                                          â”‚ â”‚
â”‚  â”‚     product_data = {                                     â”‚ â”‚
â”‚  â”‚       'name': 'Widget',                                  â”‚ â”‚
â”‚  â”‚       'sku': 'WDG-001',                                  â”‚ â”‚
â”‚  â”‚       'price': Decimal('99.99'),                         â”‚ â”‚
â”‚  â”‚       'stock_quantity': 10,                              â”‚ â”‚
â”‚  â”‚       'is_active': True,                                 â”‚ â”‚
â”‚  â”‚       'product_type': 'hardware'                         â”‚ â”‚
â”‚  â”‚     }                                                    â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  4. Upsert:                                              â”‚ â”‚
â”‚  â”‚     product, created = Product.objects.update_or_create( â”‚ â”‚
â”‚  â”‚       zoho_item_id='123',                                â”‚ â”‚
â”‚  â”‚       defaults=product_data                              â”‚ â”‚
â”‚  â”‚     )                                                    â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  5. Track Result:                                        â”‚ â”‚
â”‚  â”‚     if created:                                          â”‚ â”‚
â”‚  â”‚       stats['created'] += 1                              â”‚ â”‚
â”‚  â”‚     else:                                                â”‚ â”‚
â”‚  â”‚       stats['updated'] += 1                              â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  6. Error Handling:                                      â”‚ â”‚
â”‚  â”‚     try:                                                 â”‚ â”‚
â”‚  â”‚       # Steps 1-5                                        â”‚ â”‚
â”‚  â”‚     except Exception as e:                               â”‚ â”‚
â”‚  â”‚       log_error(e)                                       â”‚ â”‚
â”‚  â”‚       stats['failed'] += 1                               â”‚ â”‚
â”‚  â”‚       stats['errors'].append(str(e))                     â”‚ â”‚
â”‚  â”‚       continue  # Don't stop entire sync                 â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  Final Statistics:                                              â”‚
â”‚  return {                                                       â”‚
â”‚    'total': 150,        # Items fetched                        â”‚
â”‚    'created': 100,      # New products                         â”‚
â”‚    'updated': 50,       # Existing products                    â”‚
â”‚    'failed': 0,         # Errors                               â”‚
â”‚    'errors': []         # Error messages                       â”‚
â”‚  }                                                              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Django Apps & Models                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  integrations (NEW)                                             â”‚
â”‚  â”œâ”€ models.py                                                   â”‚
â”‚  â”‚  â””â”€ ZohoCredential (1:1 Singleton)                         â”‚
â”‚  â”‚     â”œâ”€ client_id                                            â”‚
â”‚  â”‚     â”œâ”€ client_secret                                        â”‚
â”‚  â”‚     â”œâ”€ access_token â—„â”€â”€â”€ Auto-refreshed                   â”‚
â”‚  â”‚     â”œâ”€ refresh_token                                        â”‚
â”‚  â”‚     â”œâ”€ expires_in                                           â”‚
â”‚  â”‚     â””â”€ is_expired() â”€â”€â”€â”€ Method                            â”‚
â”‚  â”‚                                                             â”‚
â”‚  â”œâ”€ utils.py                                                    â”‚
â”‚  â”‚  â””â”€ ZohoClient                                             â”‚
â”‚  â”‚     â”œâ”€ get_valid_token()                                    â”‚
â”‚  â”‚     â”œâ”€ fetch_products()                                     â”‚
â”‚  â”‚     â””â”€ fetch_all_products()                                 â”‚
â”‚  â”‚                                                             â”‚
â”‚  â””â”€ admin.py                                                    â”‚
â”‚     â””â”€ ZohoCredentialAdmin                                     â”‚
â”‚        â”œâ”€ Singleton enforcement                                â”‚
â”‚        â”œâ”€ Token status display                                 â”‚
â”‚        â””â”€ No delete permission                                 â”‚
â”‚                                                                 â”‚
â”‚  products_and_services (ENHANCED)                               â”‚
â”‚  â”œâ”€ models.py                                                   â”‚
â”‚  â”‚  â””â”€ Product                                                 â”‚
â”‚  â”‚     â”œâ”€ id                                                   â”‚
â”‚  â”‚     â”œâ”€ name                                                 â”‚
â”‚  â”‚     â”œâ”€ sku                                                  â”‚
â”‚  â”‚     â”œâ”€ price                                                â”‚
â”‚  â”‚     â”œâ”€ stock_quantity                                       â”‚
â”‚  â”‚     â””â”€ zoho_item_id â—„â”€â”€â”€ NEW (unique, indexed)            â”‚
â”‚  â”‚                                                             â”‚
â”‚  â”œâ”€ services.py                                                 â”‚
â”‚  â”‚  â””â”€ sync_zoho_products_to_db()                             â”‚
â”‚  â”‚     â””â”€ Uses ZohoClient                                      â”‚
â”‚  â”‚     â””â”€ Updates Product model                                â”‚
â”‚  â”‚                                                             â”‚
â”‚  â”œâ”€ tasks.py (NEW)                                             â”‚
â”‚  â”‚  â””â”€ task_sync_zoho_products                                â”‚
â”‚  â”‚     â””â”€ Celery @shared_task                                  â”‚
â”‚  â”‚     â””â”€ Wraps sync_zoho_products_to_db()                    â”‚
â”‚  â”‚                                                             â”‚
â”‚  â”œâ”€ views.py                                                    â”‚
â”‚  â”‚  â””â”€ trigger_sync_view()                                    â”‚
â”‚  â”‚     â””â”€ @staff_member_required                               â”‚
â”‚  â”‚     â””â”€ Triggers Celery task                                 â”‚
â”‚  â”‚     â””â”€ Returns redirect with message                        â”‚
â”‚  â”‚                                                             â”‚
â”‚  â””â”€ admin.py                                                    â”‚
â”‚     â””â”€ ProductAdmin                                            â”‚
â”‚        â”œâ”€ Display zoho_item_id                                 â”‚
â”‚        â””â”€ Action: sync_selected_items                          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Security Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Security Layers                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Layer 1: Authentication                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ @staff_member_required                                   â”‚ â”‚
â”‚  â”‚  â””â”€ Only staff users can trigger sync                    â”‚ â”‚
â”‚  â”‚  â””â”€ Anonymous users redirected to login                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  Layer 2: Credential Storage                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ZohoCredential Model                                     â”‚ â”‚
â”‚  â”‚  â”œâ”€ Singleton pattern (one instance)                     â”‚ â”‚
â”‚  â”‚  â”œâ”€ Cannot be deleted via admin                          â”‚ â”‚
â”‚  â”‚  â”œâ”€ Truncated display in admin                           â”‚ â”‚
â”‚  â”‚  â””â”€ Stored in database (encrypted at rest recommended)   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  Layer 3: API Permissions                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ OAuth Scope                                              â”‚ â”‚
â”‚  â”‚  â””â”€ ZohoInventory.items.READ (read-only)                â”‚ â”‚
â”‚  â”‚  â””â”€ No write/delete permissions                          â”‚ â”‚
â”‚  â”‚  â””â”€ Principle of least privilege                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  Layer 4: Token Management                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ OAuth Tokens                                             â”‚ â”‚
â”‚  â”‚  â”œâ”€ Short-lived access_token (1 hour)                    â”‚ â”‚
â”‚  â”‚  â”œâ”€ Automatic refresh                                     â”‚ â”‚
â”‚  â”‚  â”œâ”€ Refresh fails â†’ manual re-auth required              â”‚ â”‚
â”‚  â”‚  â””â”€ No token leakage in logs                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  Layer 5: Error Handling                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Safe Error Messages                                      â”‚ â”‚
â”‚  â”‚  â”œâ”€ No sensitive data in user-facing messages            â”‚ â”‚
â”‚  â”‚  â”œâ”€ Detailed logs for debugging (server-side only)       â”‚ â”‚
â”‚  â”‚  â””â”€ Generic errors to end users                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Document Version:** 1.0  
**Created:** 2025-12-31  
**Status:** Production Ready âœ…
